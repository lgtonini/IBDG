
clear all
close all
clc 

%Entrada de dos do IEEE - 123 - Regulador 1

%Coordenadas/Configuração (1-Nó, 2-Linha, 3-Transformador, 4-Regulador e 9-Nó auxiliar)
M = [0,0,1,0,0,0,0;0,0,2,0,0,0,0;1,2,1,2,1,2,1;0,0,2,0,0,0,0;0,0,1,2,1,0,0;0,0,2,0,0,0,0;0,0,1,2,1,0,0;0,0,2,0,0,0,0;0,0,1,0,0,0,0;0,0,2,0,0,0,0;0,0,1,0,0,0,0;0,0,2,0,0,0,0;0,0,1,0,0,0,0;0,0,2,0,0,0,0;0,0,1,0,0,0,0;0,0,2,0,0,0,0;0,0,1,0,0,0,0];

%Quantidade de configurações
NC = 12; 

%Configurações Y e Z
MC_Y(1:3,1:3) = (10^-6)*[5.6765 -1.8319 -0.6982; 0 5.9809 -1.1645; 0 0 5.3971];   %Configuração 1
MC_Z(1:3,1:3) = [0.4576+j*1.0780 0.1560+j*0.5017 0.1535+j*0.3849; 0 0.4666+j*1.0482 0.1580+j*0.4236; 0 0 0.4615+j*1.0651];

MC_Y(1:3,4:6) = (10^-6)*[5.9809 -1.1645 -1.8319; 0 5.3971 -0.6982; 0 0 5.6765];   %Configuração 2
MC_Z(1:3,4:6) = [0.4666+j*1.0482 0.1580+j*0.4236 0.1560+j*0.5017; 0 0.4615+j*1.0651 0.1535+j*0.3849; 0 0 0.4576+j*1.0780]; 

MC_Y(1:3,7:9) = (10^-6)*[5.3971 -0.6982 -1.1645; 0 5.6765 -1.8319; 0 0 5.9809];   %Configuração 3
MC_Z(1:3,7:9) = [0.4615+j*1.0651 0.1535+j*0.3849 0.1580+j*0.4236; 0 0.4576+j*1.0780 0.1560+j*0.5017; 0 0 0.4666+j*1.0482];

MC_Y(1:3,10:12) = (10^-6)*[5.3971 -1.1645 -0.6982; 0 5.9809 -1.8319; 0 0 5.6765]; %Configuração 4
MC_Z(1:3,10:12) = [0.4615+j*1.0651 0.1580+j*0.4236 0.1535+j*0.3849; 0 0.4666+j*1.0482 0.1560+j*0.5017; 0 0 0.4576+j*1.0780];

MC_Y(1:3,13:15) = (10^-6)*[5.9809 -1.8319 -1.1645; 0 5.6765 -0.6982; 0 0 5.3971]; %Configuração 5
MC_Z(1:3,13:15) = [0.4666+j*1.0482 0.1560+j*0.5017 0.1580+j*0.4236; 0 0.4576+j*1.0780 0.1535+j*0.3849; 0 0 0.4615+j*1.0651];

MC_Y(1:3,16:18) = (10^-6)*[5.6765 -0.6982 -1.8319; 0 5.3971 -1.1645; 0 0 5.9809]; %Configuração 6
MC_Z(1:3,16:18) = [0.4576+j*1.0780 0.1535+j*0.3849 0.1560+j*0.5017; 0 0.4615+j*1.0651 0.1580+j*0.4236; 0 0 0.4666+j*1.0482];

MC_Y(1:3,19:21) = (10^-6)*[5.1154 0 -1.0549; 0 0 0; 0 0 5.1704];                  %Configuração 7
MC_Z(1:3,19:21) = [0.4676+j*1.0780 0 0.1535+j*0.3849; 0 0 0; 0 0 0.4515+j*1.0651];

MC_Y(1:3,22:24) = (10^-6)*[5.1154 -1.0549 0; 0 5.1704 0; 0 0 0];                  %Configuração 8
MC_Z(1:3,22:24) = [0.4676+j*1.0780 0.1535+j*0.3849 0; 0 0.4615+j*1.0651 0; 0 0 0];

MC_Y(1:3,25:27) = (10^-6)*[4.5193 0 0; 0 0 0; 0 0 0];                             %Configuração 9
MC_Z(1:3,25:27) = [1.3292+j*1.3475 0 0; 0 0 0; 0 0 0];

MC_Y(1:3,28:30) = (10^-6)*[0 0 0; 0 4.5193 0; 0 0 0];                             %Configuração 10
MC_Z(1:3,28:30) = [0 0 0; 0 1.3292+j*1.3475 0; 0 0 0];

MC_Y(1:3,31:33) = (10^-6)*[0 0 0; 0 0 0; 0 0 4.5193];                             %Configuração 11
MC_Z(1:3,31:33) = [0 0 0; 0 0 0; 0 0 1.3292+j*1.3475];

MC_Y(1:3,34:36) = (10^-6)*[67.2242 0 0; 0 67.2242 0; 0 0 67.2242];                %Configuração 12
MC_Z(1:3,34:36) = [1.5209+j*0.7521 0.5198+j*0.2775 0.4924+j*0.2157; 0 1.5329+j*0.7162 0.5198+j*0.2775; 0 0 1.5209+j*0.7521];

%Distâncias e configuração entre os nós
Dist(13,1)=825*0.000189394;             %18-13 - 1
Dist(13,2)=2;             %Configuração 2

Dist(28,1)=0;            %135-18 - 2
Dist(28,2)=2;             %Configuração 2 (Chave)

Dist(17,1)=250*0.000189394;           %19-18 - 3
Dist(17,2)=9;             %Configuração 9

Dist(11,1)=250*0.000189394;             %20-19 - 4
Dist(11,2)=9;             %Configuração 9

Dist(38,1)=300*0.000189394;               %18-21 - 5
Dist(38,2)=2;             %Configuração 2

Dist(41,1)=525*0.000189394;             %21-22 - 6
Dist(41,2)=10;             %Configuração 10

Dist(43,1)=250*0.000189394;           %21-23 - 7
Dist(43,2)=2;            %Configuração 2

Dist(45,1)=550*0.000189394;            %24-23 - 8
Dist(45,2)=11;             %Configuração 11
 
Dist(46,1)=275*0.000189394;            %23-25 - 9
Dist(46,2)=2;             %Configuração 2

Dist(48,1)=200*0.000189394;           %25-28 - 10
Dist(48,2)=2;             %Configuração 2

Dist(52,1)=300*0.000189394;            %28-29 - 11
Dist(52,2)=2;             %Configuração 2

Dist(56,1)=350*0.000189394;             %29-30 - 12
Dist(56,2)=2;            %Configuração 2

Dist(61,1)=200*0.000189394;             %30-250 - 13
Dist(61,2)=2;             %Configuração 2

%Potência nos nós em estrela e delta (TC = Tipo de carga: 1-S, 2-I ou 3-Z)
%PPA = Percentual de Potência Ativa
PPA = 0             %Nó 13 - 1
SN(1:3,15)=[0,0,0]; 
SN(4:6,15)=[0,0,0];

PPA = 0             %Nó 135 - 2
SN(1:3,28)=[0,0,0];                                                                                                                      
SN(4:6,28)=[0,0,0];

PPA = 0             %Nó 18 - 3
SN(1:3,13)=[0,0,0];                                                                                        
SN(4:6,13)=[0,0,0];

PPA = 0             %Nó 19 - 4
SN(1:3,15)=[((40+1i*20)*1e3),0,0];
TC_Y(15) = 1;
SN(4:6,15)=[0,0,0];

PPA = 0             %Nó 20 - 5
SN(1:3,10)=[((40+1i*20)*1e3),0,0];                                                                                                         
TC_Y(10) = 2;
SN(4:6,10)=[0,0,0];

PPA = 0             %Nó 21 - 6
SN(1:3,40)=[0,0,0];                                                                                                  
SN(4:6,40)=[0,0,0]

PPA = 0             %Nó 22 - 7
SN(1:3,39)=[0,((40+j*20)*1e3),0];
TC_Y(39) = 3;
SN(4:6,39)=[0,0,0];

PPA = 0             %Nó 23 - 8
SN(1:3,45)=[0,0,0];                                                                                            
SN(4:6,45)=[0,0,0];

PPA = 0             %Nó 24 - 9
SN(1:3,44)=[0,0,((40+1i*20)*1e3)];                                                                                                        
TC_Y(44) = 1;
SN(4:6,44)=[0,0,0];

PPA = 0             %Nó 25 - 10
SN(1:3,47)=[0,0,0];                                                                                                                   
SN(4:6,47)=[0,0,0];

PPA = 0             %Nó 28 - 11
SN(1:3,49)=[((40+j*20)*1e3),0,0];                                                                                                         
TC_Y(49) = 2;
SN(4:6,49)=[0,0,0];

PPA = 0             %Nó 29 - 12
SN(1:3,53)=[((40+j*20)*1e3),0,0];                                                                    
TC_Y(53) = 3;
SN(4:6,53)=[0,0,0];

PPA = 0             %Nó 30 - 13
SN(1:3,57)=[0,0,((40+1i*20)*1e3)];                                                                                                      
TC_Y(57) = 1;
SN(4:6,57)=[0,0,0];

PPA = 0             %Nó 250 - 14
SN(1:3,62)=[0,0,0];                                                                         
SN(4:6,62)=[0,0,0];

%Tensão de referência
Vref = (4.16*10^3)/sqrt(3);

%Erro
Erro = 0.001;

