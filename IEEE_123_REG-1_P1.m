
clear all
close all
clc 

%Entrada de dos do IEEE - 123 - Regulador 1

%Coordenadas/Configuração (1-Nó, 2-Linha, 3-Transformador, 4-Regulador e 9-Nó auxiliar)
M = [0,0,0,0,0,0,1,0,0,0,0,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;0,0,0,0,0,0,1,0,0,0,0,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;1,2,1,2,1,2,1,2,1,0,0,0,0;0,0,0,0,2,0,2,0,0,0,0,0,0;0,0,0,0,1,0,1,0,0,0,0,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;0,0,0,0,1,2,1,2,1,0,0,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;0,0,0,0,0,0,1,2,1,2,1,2,1;0,0,0,0,0,0,2,0,0,0,2,0,0;0,0,0,0,0,0,1,0,0,0,1,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;0,0,0,0,0,0,1,0,0,0,0,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;0,0,0,0,0,0,1,0,0,0,0,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;0,0,0,0,0,0,1,2,1,2,1,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;0,0,0,0,0,0,1,0,0,0,0,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;0,0,0,0,0,0,1,0,0,0,0,0,0;0,0,0,0,0,0,2,0,0,0,0,0,0;0,0,0,0,0,0,1,0,0,0,0,0,0];

%Quantidade de configurações
NC = 12; 

%Configurações Y e Z
MC_Y(1:3,1:3) = (10^-6)*[5.6765 -1.8319 -0.6982; 0 5.9809 -1.1645; 0 0 5.3971];   %Configuração 1
MC_Z(1:3,1:3) = [0.4576+j*1.0780 0.1560+j*0.5017 0.1535+j*0.3849; 0 0.4666+j*1.0482 0.1580+j*0.4236; 0 0 0.4615+j*1.0651];

MC_Y(1:3,4:6) = (10^-6)*[5.9809 -1.1645 -1.8319; 0 5.3971 -0.6982; 0 0 5.6765];   %Configuração 2
MC_Z(1:3,4:6) = [0.4666+j*1.0482 0.1580+j*0.4236 0.1560+j*0.5017; 0 0.4615+j*1.0651 0.1535+j*0.3849; 0 0 0.4576+j*1.0780]; 

MC_Y(1:3,7:9) = (10^-6)*[5.3971 -0.6982 -1.1645; 0 5.6765 -1.8319; 0 0 5.9809];   %Configuração 3
MC_Z(1:3,7:9) = [0.4615+j*1.0651 0.1535+j*0.3849 0.1580+j*0.4236; 0 0.4576+j*1.0780 0.1560+j*0.5017; 0 0 0.4666+j*1.0482];

MC_Y(1:3,10:12) = (10^-6)*[5.3971 -1.1645 -0.6982; 0 5.9809 -1.8319; 0 0 5.6765]; %Configuração 4
MC_Z(1:3,10:12) = [0.4615+j*1.0651 0.1580+j*0.4236 0.1535+j*0.3849; 0 0.4666+j*1.0482 0.1560+j*0.5017; 0 0 0.4576+j*1.0780];

MC_Y(1:3,13:15) = (10^-6)*[5.9809 -1.8319 -1.1645; 0 5.6765 -0.6982; 0 0 5.3971]; %Configuração 5
MC_Z(1:3,13:15) = [0.4666+j*1.0482 0.1560+j*0.5017 0.1580+j*0.4236; 0 0.4576+j*1.0780 0.1535+j*0.3849; 0 0 0.4615+j*1.0651];

MC_Y(1:3,16:18) = (10^-6)*[5.6765 -0.6982 -1.8319; 0 5.3971 -1.1645; 0 0 5.9809]; %Configuração 6
MC_Z(1:3,16:18) = [0.4576+j*1.0780 0.1535+j*0.3849 0.1560+j*0.5017; 0 0.4615+j*1.0651 0.1580+j*0.4236; 0 0 0.4666+j*1.0482];

MC_Y(1:3,19:21) = (10^-6)*[5.1154 0 -1.0549; 0 0 0; 0 0 5.1704];                  %Configuração 7
MC_Z(1:3,19:21) = [0.4676+j*1.0780 0 0.1535+j*0.3849; 0 0 0; 0 0 0.4515+j*1.0651];

MC_Y(1:3,22:24) = (10^-6)*[5.1154 -1.0549 0; 0 5.1704 0; 0 0 0];                  %Configuração 8
MC_Z(1:3,22:24) = [0.4676+j*1.0780 0.1535+j*0.3849 0; 0 0.4615+j*1.0651 0; 0 0 0];

MC_Y(1:3,25:27) = (10^-6)*[4.5193 0 0; 0 0 0; 0 0 0];                             %Configuração 9
MC_Z(1:3,25:27) = [1.3292+j*1.3475 0 0; 0 0 0; 0 0 0];

MC_Y(1:3,28:30) = (10^-6)*[0 0 0; 0 4.5193 0; 0 0 0];                             %Configuração 10
MC_Z(1:3,28:30) = [0 0 0; 0 1.3292+j*1.3475 0; 0 0 0];

MC_Y(1:3,31:33) = (10^-6)*[0 0 0; 0 0 0; 0 0 4.5193];                             %Configuração 11
MC_Z(1:3,31:33) = [0 0 0; 0 0 0; 0 0 1.3292+j*1.3475];

MC_Y(1:3,34:36) = (10^-6)*[67.2242 0 0; 0 67.2242 0; 0 0 67.2242];                %Configuração 12
MC_Z(1:3,34:36) = [1.5209+j*0.7521 0.5198+j*0.2775 0.4924+j*0.2157; 0 1.5329+j*0.7162 0.5198+j*0.2775; 0 0 1.5209+j*0.7521];

%Distâncias e configuração entre os nós
Dist(1,1)=0;             %150-149 - 1
Dist(1,2)=1;             %Configuração 1 (Regulador 1)

Dist(2,1)=400*0.000189394;             %149-1 - 2
Dist(2,2)=1;             %Configuração 1 

Dist(3,1)=250*0.000189394;            %6-5 - 3
Dist(3,2)=11;             %Configuração 11 

Dist(4,1)=325*0.000189394;             %5-3 - 4
Dist(4,2)=11;             %Configuração 11 

Dist(5,1)=250*0.000189394;            %3-1 - 5
Dist(5,2)=11;             %Configuração 11 

Dist(6,1)=175*0.000189394;            %1-2 - 6
Dist(6,2)=10;             %Configuração 10

Dist(7,1)=200*0.000189394;               %3-4 - 7
Dist(7,2)=11;             %Configuração 11

Dist(8,1)=300*0.000189394;              %1-7 - 8
Dist(8,2)=1;             %Configuração 1

Dist(9,1)=200*0.000189394;             %7-8 - 9
Dist(9,2)=1;             %Configuração 1

Dist(10,1)=225*0.000189394;           %9-8 - 10
Dist(10,2)=9;            %Configuração 9

Dist(11,1)=225*0.000189394;           %8-12 - 11
Dist(11,2)=10;             %Configuração 10

Dist(12,1)=300*0.000189394;           %8-13 - 12
Dist(12,2)=1;             %Configuração 1

Dist(15,1)=150*0.000189394;             %13-34 - 13
Dist(15,2)=11;             %Configuração 11

Dist(16,1)=100*0.000189394;             %34-15 - 14
Dist(16,2)=11;             %Configuração 11 

Dist(17,1)=375*0.000189394;             %15-16 - 15
Dist(17,2)=11;             %Configuração 11

Dist(18,1)=0;                            %13-152 - 16
Dist(18,2)=1;             %Configuração 1 (Chave)

Dist(19,1)=350*0.000189394;             %15-17 - 17
Dist(19,2)=11;             %Configuração 11

Dist(20,1)=400*0.000189394;           %152-52 - 18
Dist(20,2)=1;            %Configuração 1

Dist(21,1)=200*0.000189394;            %52-53 - 19
Dist(21,2)=1;             %Configuração 1

Dist(22,1)=125*0.000189394;           %53-54 - 20
Dist(22,2)=1;             %Configuração 1

Dist(61,1)=275*0.000189394;           %54-55 - 21
Dist(61,2)=1;             %Configuração 1

Dist(60,1)=275*0.000189394;              %55-56 - 22
Dist(60,2)=1;             %Configuração 1

Dist(64,1)=350*0.000189394;            %54-57 - 23
Dist(64,2)=3;             %Configuração 3

Dist(66,1)=250*0.000189394;            %57-58 - 24
Dist(66,2)=10;            %Configuração 10

Dist(65,1)=250*0.000189394;            %58-59 - 25
Dist(65,2)=10;             %Configuração 10

 
%Potência nos nós em estrela e delta (TC = Tipo de carga: 1-S, 2-I ou 3-Z)
%PPA = Percentual de Potência Ativa
PPA = 0             %Nó 150 - 1
SN(1:3,1)=[0,0,0];
SN(4:6,1)=[0,0,0];

PPA = 0            %Nó 149 - 2
SN(1:3,2)=[0,0,0];                                                                                
SN(4:6,2)=[0,0,0];

PPA = 0             %Nó 6 - 3
SN(1:3,3)=[0,0,((40+1i*20)*1e3)];                                                                                 
TC_Y(3) = 3;
SN(4:6,3)=[0,0,0];

PPA = 0             %Nó 5 - 4 
SN(1:3,4)=[0,0,((20+1i*10)*1e3)];                                                                                                               
TC_Y(4) = 2;
SN(4:6,4)=[0,0,0];

PPA = 0             %Nó 3 - 5
SN(1:3,5)=[0,0,0];                                                                             
SN(4:6,5)=[0,0,0];

PPA = 0             %Nó 1 - 6  
SN(1:3,6)=[((40+1i*20)*1e3),0,0];
TC_Y(6) = 1;
SN(4:6,6)=[0,0,0];

PPA = 0             %Nó 2 - 7
SN(1:3,7)=[0,((20+1i*10)*1e3),0];
TC_Y(7) = 1;
SN(4:6,7)=[0,0,0];

PPA = 0             %Nó 4 - 8
SN(1:3,8)=[0,0,((40+1i*20)*1e3)];
TC_Y(8) = 1;
SN(4:6,8)=[0,0,0];

PPA = 0             %Nó 7 - 9
SN(1:3,9)=[((20+1i*10)*1e3),0,0];
TC_Y(9) = 1;
SN(4:6,9)=[0,0,0];

PPA = 0             %Nó 9 - 10
SN(1:3,10)=[((40+1i*20)*1e3),0,0];                                                                                           
TC_Y(10) = 1;
SN(4:6,10)=[0,0,0];

PPA = 0             %Nó 8 - 11
SN(1:3,11)=[0,0,0];                                                                                                        
SN(4:6,11)=[0,0,0];

PPA = 0             %Nó 12 - 12
SN(1:3,12)=[0,((20+1i*10)*1e3),0];                                                                                             
TC_Y(12) = 1;
SN(4:6,12)=[0,0,0];

PPA = 0             %Nó 13 - 13
SN(1:3,15)=[0,0,0]; 
SN(4:6,15)=[0,0,0];

PPA = 0             %Nó 34 - 14  
SN(1:3,16)=[0,0,((40+j*20)*1e3)];                                                                                              
TC_Y(16) = 3;
SN(4:6,16)=[0,0,0];

PPA = 0             %Nó 15 - 15
SN(1:3,17)=[0,0,0];                                                                                 
SN(4:6,17)=[0,0,0];

PPA = 0             %Nó 16 - 16
SN(1:3,18)=[0,0,((40+j*20)*1e3)];                                                                                                                
TC_Y(18) = 1;
SN(4:6,18)=[0,0,0];

PPA = 0             %Nó 152 - 17    
SN(1:3,19)=[0,0,0];                                                
SN(4:6,19)=[0,0,0];

PPA = 0             %Nó 17 - 18
SN(1:3,20)=[0,0,((20+1i*10)*1e3)];                                                                                          
TC_Y(20) = 1;
SN(4:6,20)=[0,0,0];

PPA = 0             %Nó 52 - 19
SN(1:3,21)=[((40+j*20)*1e3),0,0];                                                                                                          
TC_Y(21) = 1;
SN(4:6,21)=[0,0,0];

PPA = 0             %Nó 53 - 20
SN(1:3,22)=[((40+j*20)*1e3),0,0];
TC_Y(22) = 1;
SN(4:6,22)=[0,0,0];

PPA = 0             %Nó 54 - 21
SN(1:3,23)=[0,0,0];                                                                                                        
SN(4:6,23)=[0,0,0];

PPA = 0             %Nó 55 - 22 
SN(1:3,61)=[((20+j*10)*1e3),0,0];                                                                                                                      
TC_Y(61) = 3;
SN(4:6,61)=[0,0,0];

PPA = 0             %Nó 56 - 23  
SN(1:3,60)=[0,((20+j*10)*1e3),0];                                                                                                       
TC_Y(60) = 1;
SN(4:6,60)=[0,0,0];

PPA = 0             %Nó 57 - 24
SN(1:3,67)=[0,0,0];                                                                                                      
SN(4:6,67)=[0,0,0];

PPA = 0             %Nó 58 - 25
SN(1:3,66)=[0,(20+j*10)*1e3,0];                                                                                   
TC_Y(66) = 2;
SN(4:6,66)=[0,0,0];

PPA = 0             %Nó 59 - 26
SN(1:3,65)=[0,((20+j*10)*1e3),0];                                                                         
TC_Y(65) = 1;
SN(4:6,65)=[0,0,0];


%Tensão de referência
Vref = (4.16*10^3)/sqrt(3);

%Erro
Erro = 0.001;

