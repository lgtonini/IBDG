
clear all
close all
clc 

%Entrada de dos do IEEE - 34

%Configuração (1-Nó, 2-Linha, 3-Transformador e 4-Regulador)
[0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,1,2,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,2,1,2,1,2,1,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,2,1,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,1,2,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;1,2,1,3,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,2,1,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,2,1,2,1,2,1,2,1;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;1,2,1,2,1,0,0,0,0,0,0,0,0;0,0,0,0,2,0,0,0,0,0,0,0,0;0,0,0,0,1,0,0,0,0,0,0,0,0]

%Quantidade de configurações
NC = 5;

%Configurações Y e Z
MC_Y(1:3,1:3) = (10^-6)*[5.3350 -1.5313 -0.9943 ; -1.5313 5.0979 -0.6212 ; -0.9943 -0.6212 4.8880]; %300 - 1
MC_Z(1:3,1:3) = [1.3368+j*1.3343 0.2101+j*0.5779 0.2130+j*0.5015 ; 0.2101+j*0.5779 1.3238+j*1.3569 0.2066+j*0.4591; 0.2130+j*0.5015 0.2066+j*0.4591 1.3294+j*1.3471];

MC_Y(1:3,4:6) = (10^-6)*[5.1207 -1.4364 -0.9402 ; -1.4364 4.9055 -0.5951 ; -0.9402 -0.5951 4.7154]; %301 - 2
MC_Z(1:3,4:6) = [1.9300+j*1.4115 0.2327+j*0.6442 0.2359+j*0.5691 ; 0.2327+j*0.6442 1.9157+j*1.4281 0.2288+j*0.5238; 0.2359+j*0.5691 0.2288+j*0.5238 1.9219+j*1.4209]; 

MC_Y(1:3,7:9) = (10^-6)*[4.2251 0 0 ; 0 0 0 ; 0 0 0];                                               %302 - 3
MC_Z(1:3,7:9) = [2.7995+j*1.4855 0 0 ; 0 0 0 ; 0 0 0];

MC_Y(1:3,10:12) = (10^-6)*[0.000000001 0 0; 0 4.2251 0 ; 0 0 0];                                    %303 - 4
MC_Z(1:3,10:12) = [0.000000001 0 0 ; 0 2.7995+j*1.4855 0 ; 0 0 0];

MC_Y(1:3,10:12) = (10^-6)*[0.000000001 0 0; 0 4.3637 0 ; 0 0 0];                                    %304 - 5
MC_Z(1:3,10:12) = [0.000000001 0 0 ; 0 1.9217+j*1.4212 0 ; 0 0 0];

%Distâncias e configuração entre os nós
Dist(1,1)=2580*0.000189394;             %800-802 - 1-2
Dist(1,2)=1;             %300 

Dist(2,1)=1730*0.000189394;             %802-806 - 2-3
Dist(2,2)=1;             %300 

Dist(3,1)=32230*0.000189394;            %806-808 - 3-5
Dist(3,2)=1;             %300 

Dist(4,1)=5804*0.000189394;             %808-810 - 4-5
Dist(4,2)=4;             %303 

Dist(5,1)=37500*0.000189394;            %808-812 - 5-6
Dist(5,2)=1;             %300 

Dist(6,1)=29730*0.000189394;            %812-814 - 6-7
Dist(6,2)=1;             %300 

Dist(7,1)=50*0.000189394;               %814-850 - 7-8
Dist(7,2)=2;             %301

Dist(8,1)=310*0.000189394;              %850-816 - 8-9
Dist(8,2)=2;             %301

Dist(9,1)=1710*0.000189394;             %816-818 - 9-10
Dist(9,2)=3;             %302

Dist(10,1)=48150*0.000189394;           %818-820 - 10-11
Dist(10,2)=3;            %302

Dist(11,1)=13740*0.000189394;           %820-822 - 11-12
Dist(11,2)=3;            %302

Dist(12,1)=10210*0.000189394;           %816-824 - 9-13
Dist(12,2)=2;            %301

Dist(13,1)=3030*0.000189394;            %824-826 - 13-14
Dist(13,2)=4;             %303

Dist(14,1)=840*0.000189394;             %824-828 - 13-15
Dist(14,2)=2;             %301

Dist(15,1)=20440*0.000189394;           %828-830 - 15-16
Dist(15,2)=2;             %301

Dist(16,1)=520*0.000189394;             %830-854 - 16-18
Dist(16,2)=2;             %301

Dist(17,1)=23330*0.000189394;           %854-856 - 17-18
Dist(17,2)=4;             %303

Dist(18,1)=36830*0.000189394;           %854-852 - 18-19
Dist(18,2)=2;             %301

Dist(19,1)=50*0.000189394;              %852-832 - 19-22
Dist(19,2)=2;             %301

Dist(20,1)=10560*0.000189394;           %890-888 - 20-21
Dist(20,2)=1;             %300

Dist(21,1)=0;                           %888-832 - 21-22 - Transformador
Dist(21,2)=2;             %301

Dist(22,1)=4900*0.000189394;            %832-858 - 22-23
Dist(22,2)=2;             %301

Dist(23,1)=1620*0.000189394;            %858-864 - 23-24
Dist(23,2)=3;             %302

Dist(24,1)=5830*0.000189394;            %858-834 - 23-25
Dist(24,2)=2;            %301

Dist(25,1)=280*0.000189394;             %834-842 - 25-26
Dist(25,2)=2;            %301

Dist(26,1)=1350*0.000189394;            %842-844 - 26-27
Dist(26,2)=2;             %301 

Dist(27,1)=3640*0.000189394;            %844-846 - 27-28
Dist(27,2)=2;             %301 

Dist(28,1)=530*0.000189394;             %846-848 - 28-29
Dist(28,2)=2;             %301 

Dist(29,1)=2020*0.000189394;            %834-860 - 25-30
Dist(29,2)=2;             %301 

Dist(30,1)=310*0.000189394;             %860-836 - 30-33 
Dist(30,2)=2;             %301 

Dist(31,1)=4860*0.000189394;            %838-862 - 31-32
Dist(31,2)=5;             %304

Dist(32,1)=280*0.000189394;             %862-836 - 32-33
Dist(32,2)=2;             %301

Dist(33,1)=860*0.000189394;             %836-840 - 33-34
Dist(33,2)=2;             %301

%Potência nos nós em estrela e delta
PPA = 0
SN(1:3,1)=[0,0,0];                                                    %800 - 1                                           
SN(4:6,1)=[0,0,0];

PPA = 1
SN(1:3,2)=[0,((30+j*15)*1e3)/2,((25+j*14)*1e3)/2];                    %802 - 2                                                                             
TC_Y(2) = 1;
SN(4:6,2)=[0,0,0];

PPA = 1
SN(1:3,3)=[0,((30+j*15)*1e3)/2,((25+j*14)*1e3)/2];                    %806 - 3                                                               
TC_Y(3) = 1;
SN(4:6,3)=[0,0,0];

PPA = 1
SN(1:3,4)=[0,((16+j*8)*1e3)/2,0];                                     %810 - 4                                                                            
TC_Y(4) = 2;
SN(4:6,4)=[0,0,0];

PPA = 1
SN(1:3,5)=[0,((16+j*8)*1e3)/2,0];                                     %808 - 5                                       
TC_Y(5) = 2;
SN(4:6,5)=[0,0,0];

PPA = 0
SN(1:3,6)=[0,0,0];                                                    %812 - 6                                 
SN(4:6,6)=[0,0,0];

PPA = 0
SN(1:3,7)=[0,0,0];                                                    %814 - 7                                                                 
SN(4:6,7)=[0,0,0];

PPA = 0
SN(1:3,8)=[0,0,0];                                                    %850 - 8                                                                             
SN(4:6,8)=[0,0,0];

PPA = 1
SN(1:3,9)=[0,0,0];                                                    %816 - 9                 
SN(4:6,9)=[0,((5+j*2)*1e3)/2,0];
TC_D(9) = 2;

PPA = 1
SN(1:3,10)=[((34+j*17)*1e3)/2,0,0];                                   %818 - 10                                                               
TC_Y(10) = 3;
SN(4:6,10)=[0,0,0];

PPA = 1
SN(1:3,11)=[((34+j*17)*1e3)/2+((135+j*70)*1e3)/2,0,0];                %820 - 11                                 
TC_Y(11) = 1;
SN(4:6,11)=[0,0,0];

PPA = 1
SN(1:3,12)=[((135+j*70)*1e3)/2,0,0];                                  %822 - 12                                                         
TC_Y(12) = 1;
SN(4:6,12)=[0,0,0];

PPA = 1
SN(1:3,13)=[0,((40+j*20)*1e3)/2,((4+j*2)*1e3)/2];                     %824 - 13                                                                      
TC_Y(13) = 2;
SN(4:6,13)=[0,((5+j*2)*1e3)/2,0];
TC_D(13) = 2;

PPA = 1
SN(1:3,14)=[0,((40+j*20)*1e3)/2,0];                                   %826 - 14                                                                     
TC_Y(14) = 2;
SN(4:6,14)=[0,0,0];

PPA = 1
SN(1:3,15)=[((7+j*3)*1e3)/2,0,((4+j*2)*1e3)/2];                       %828 - 15                                                                      
TC_Y(15) = 1;
SN(4:6,15)=[0,0,0];

PPA = 1
SN(1:3,16)=[((7+j*3)*1e3)/2,0,0];                                     %830 - 16                                                                     
TC_Y(16) = 1;
SN(4:6,16)=[(10+j*5)*1e3,(10+j*5)*1e3,(25+j*10)*1e3];
TC_D(16) = 3;

PPA = 1
SN(1:3,17)=[0,((4+j*2)*1e3)/2,0];                                     %856 - 17                                                                    
TC_Y(17) = 1;
SN(4:6,17)=[0,0,0];

PPA = 1
SN(1:3,18)=[0,((4+j*2)*1e3)/2,0];                                     %854 - 18                                                                     
TC_Y(18) = 1;
SN(4:6,18)=[0,0,0];

PPA = 0
SN(1:3,19)=[0,0,0];                                                   %852 - 19                                                                     
SN(4:6,19)=[0,0,0];

PPA = 1
SN(1:3,20)=[0,0,0];                                                   %890 - 20                                                                   
SN(4:6,20)=[(150+j*75)*1e3,(150+j*75)*1e3,(150+j*75)*1e3];
TC_D(20) = 2;

PPA = 0
SN(1:3,21)=[0,0,0];                                                   %888 - 21                                                                    
SN(4:6,21)=[0,0,0];

PPA = 1
SN(1:3,22)=[0,0,0];                                                   %832 - 22                                                                   
SN(4:6,22)=[((7+j*3)*1e3)/2,((2+j*1)*1e3)/2,((6+j*3)*1e3)/2];
TC_D(22) = 3;

PPA = 1
SN(1:3,23)=[((2+j*1)*1e3)/2,0,0];                                     %858 - 23                                                                    
TC_Y(23) = 1;
SN(4:6,23)=[((7+j*3)*1e3)/2+((4+j*2)*1e3)/2,((2+j*1)*1e3)/2+((15+j*8)*1e3)/2,((6+j*3)*1e3)/2+((13+j*7)*1e3)/2];
TC_D(23) = 3;

PPA = 1
SN(1:3,24)=[((2+j*1)*1e3)/2,0,0];                                     %864 - 24                                                                    
TC_Y(24) = 1;
SN(4:6,24)=[0,0,0];

PPA = 1
SN(1:3,25)=[0,0,0];                                                   %834 - 25                                                                    
SN(4:6,25)=[((4+j*2)*1e3)/2+((16+j*8)*1e3)/2,((15+j*8)*1e3)/2+((20+j*10)*1e3)/2,((13+j*7)*1e3)/2+((110+j*55)*1e3)/2];
TC_D(25) = 3; %Há S e Z, a escolha foi Z>S

PPA = 1
SN(1:3,26)=[((9+j*5)*1e3)/2,0,0];                                     %842 - 26                                                                    
TC_Y(26) = 1;
SN(4:6,26)=[0,0,0];

PPA = 1
SN(1:3,27)=[0,0,0];                                                   %844 - 27                                                                   
SN(4:6,27)=[(135+j*105)*1e3+((9+j*5)*1e3)/2-j*100*1e3,(135+j*105)*1e3+((25+j*12)*1e3)/2-j*100*1e3,(135+j*105)*1e3+((20+j*11)*1e3)/2-j*100*1e3];
TC_D(27) = 3; %Há S e Z, a escolha foi Z>S

PPA = 1
SN(1:3,28)=[0,((25+j*12)*1e3)/2+((23+j*11)*1e3)/2,((20+j*11)*1e3)/2]; %846 - 28                                                                    
TC_Y(28) = 1;
SN(4:6,28)=[0,0,0];

PPA = 1
SN(1:3,29)=[-j*150*1e3,((23+j*11)*1e3)/2- j*150*1e3,-j*150*1e3];      %848 - 29                                                                    
TC_Y(29) = 1;
SN(4:6,29)=[(20+j*16)*1e3,(20+j*16)*1e3,(20+j*16)*1e3];
TC_D(29) = 1;

PPA = 1
SN(1:3,30)=[(20+j*16)*1e3,(20+j*16)*1e3,(20+j*16)*1e3];               %860 - 30                                                                    
TC_Y(30) = 1;
SN(4:6,30)=[((16+j*8)*1e3)/2+((30+j*15)*1e3)/2,((20+j*10)*1e3)/2+((10+j*6)*1e3)/2,((110+j*55)*1e3)/2+((42+j*22)*1e3)/2];
TC_D(30) = 1;

PPA = 1
SN(1:3,31)=[0,((28+j*14)*1e3)/2,0];                                   %838 - 31                                                                    
TC_Y(31) = 1;
SN(4:6,31)=[0,0,0];

PPA = 1
SN(1:3,32)=[0,((28+1i*14)*1e3)/2,0];                                   %862 - 32                                                                    
TC_Y(32) = 1;
SN(4:6,32)=[0,0,0];

PPA = 1
SN(1:3,33)=[0,0,0];                                                   %836 - 33                                                                    
SN(4:6,33)=[((30+j*15)*1e3)/2+((18+j*9)*1e3)/2,((10+j*6)*1e3)/2+((22+j*11)*1e3)/2,((42+j*22)*1e3)/2];
TC_D(33) = 1; %Há S e I, a escolha foi S>I

PPA = 1
SN(1:3,34)=[(9+j*7)*1e3,(9+j*7)*1e3,(9+j*7)*1e3];                     %840 - 34                                                                    
TC_Y(34) = 2;
SN(4:6,34)=[((18+j*9)*1e3)/2,((22+j*11)*1e3)/2,0];
TC_D(34) = 2;

%Transformador:
    %Configurações 
1;
    %Tipo de transformador(1-DYg e 2-YgYg)
2;
    %Potência(VA)
500*10^3;
    %Tensão de entrada(V)
24.9*10^3;
    %Tensão de saída(V)
4.16*10^3;
    %Impedâcia
0.019+j*0.0408;

%Regulador de tensão 1:
    %Relação de transformação
120;
    %Impedância
(2.7+1.6*j)/100;

%Regulador de tensão 2:
    %Relação de transformação
120;
    %Impedância
(2.5+1.5*j)/100;

%Tensão de referência
Vref = 1.05*(24.9*10^3)/sqrt(3);

%Erro
Erro = 0.001;

