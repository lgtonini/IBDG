
clear all
close all
clc 

%Entrada de dos do IEEE - 123 - Regulador 1

%Coordenadas/Configuração (1-Nó, 2-Linha, 3-Transformador, 4-Regulador e 9-Nó auxiliar)
M = [1,0,0,0,0,0,0,0,0,0,0,0,0;2,0,0,0,0,0,0,0,0,0,0,0,0;1,0,0,0,0,0,0,0,0,0,0,0,0;2,0,0,0,0,0,0,0,0,0,0,0,0;1,2,1,2,1,2,1,0,0,0,0,0,0;2,0,0,0,0,0,0,0,0,0,0,0,0;1,2,1,2,1,2,1,2,1,2,1,2,1;2,0,0,0,2,0,0,0,2,0,0,0,0;1,0,0,0,1,0,0,0,1,0,0,0,0;2,0,0,0,0,0,0,0,2,0,0,0,0;1,2,1,0,0,0,0,0,1,0,0,0,0;2,0,0,0,0,0,0,0,0,0,0,0,0;1,2,1,0,0,0,0,0,0,0,0,0,0;2,0,0,0,0,0,0,0,0,0,0,0,0;1,2,1,0,0,0,0,0,0,0,0,0,0;2,0,0,0,0,0,0,0,0,0,0,0,0;1,2,1,0,0,0,0,0,0,0,0,0,0;2,0,0,0,0,0,0,0,0,0,0,0,0;1,0,0,0,0,0,0,0,0,0,0,0,0;2,0,0,0,0,0,0,0,0,0,0,0,0;1,0,0,0,0,0,0,0,0,0,0,0,0];

%Quantidade de configurações
NC = 5; 

%Configurações Y e Z
MC_Y(1:3,7:9) = (10^-6)*[5.3971 -0.6982 -1.1645; 0 5.6765 -1.8319; 0 0 5.9809];   %Configuração 3
MC_Z(1:3,7:9) = [0.4615+j*1.0651 0.1535+j*0.3849 0.1580+j*0.4236; 0 0.4576+j*1.0780 0.1560+j*0.5017; 0 0 0.4666+j*1.0482];

MC_Y(1:3,16:18) = (10^-6)*[5.6765 -0.6982 -1.8319; 0 5.3971 -1.1645; 0 0 5.9809]; %Configuração 6
MC_Z(1:3,16:18) = [0.4576+j*1.0780 0.1535+j*0.3849 0.1560+j*0.5017; 0 0.4615+j*1.0651 0.1580+j*0.4236; 0 0 0.4666+j*1.0482];

MC_Y(1:3,25:27) = (10^-6)*[4.5193 0 0; 0 0 0; 0 0 0];                             %Configuração 9
MC_Z(1:3,25:27) = [1.3292+j*1.3475 0 0; 0 0 0; 0 0 0];

MC_Y(1:3,28:30) = (10^-6)*[0 0 0; 0 4.5193 0; 0 0 0];                             %Configuração 10
MC_Z(1:3,28:30) = [0 0 0; 0 1.3292+j*1.3475 0; 0 0 0];

MC_Y(1:3,31:33) = (10^-6)*[0 0 0; 0 0 0; 0 0 4.5193];                             %Configuração 11
MC_Z(1:3,31:33) = [0 0 0; 0 0 0; 0 0 1.3292+j*1.3475];

%Distâncias e configuração entre os nós
Dist(78,1)=350*0.000189394;             %160-67 - Regulador 4 - 1
Dist(78,2)=2;             %Configuração 2-6

Dist(87,1)=275*0.000189394;             %72-67 - 2
Dist(87,2)=1;             %Configuração 1-3

Dist(97,1)=275*0.000189394;             %72-73 - 87-98 - 97
Dist(97,2)=5;             %Configuração 5-11

Dist(104,1)=350*0.000189394;             %73-74 - 4
Dist(104,2)=5;             %Configuração 5-11

Dist(108,1)=400*0.000189394;             %74-75 - 5
Dist(108,2)=5;             %Configuração 5-11

Dist(86,1)=200*0.000189394;             %76-72 - 6
Dist(86,2)=1;             %Configuração 1-3

Dist(96,1)=400*0.000189394;             %76-77 - 7
Dist(96,2)=2;             %Configuração 2-6

Dist(103,1)=100*0.000189394;             %77-78 - 8
Dist(103,2)=2;             %Configuração 2-6

Dist(107,1)=475*0.000189394;             %78-80 - 9
Dist(107,2)=2;             %Configuração 2-6

Dist(113,1)=475*0.000189394;             %80-81 - 10
Dist(113,2)=2;             %Configuração 2-6

Dist(119,1)=675*0.000189394;             %81-84 - 11
Dist(119,2)=5;             %Configuração 5-11

Dist(122,1)=475*0.000189394;             %84-85 - 12
Dist(122,2)=5;             %Configuração 5-11

Dist(85,1)=700*0.000189394;             %86-76 - 13
Dist(85,2)=1;             %Configuração 1-3

Dist(106,1)=225*0.000189394;             %79-78 - 14
Dist(106,2)=2;             %Configuração 2-6

Dist(116,1)=250*0.000189394;             %82-81 - 15
Dist(116,2)=2;             %Configuração 2-6

Dist(84,1)=450*0.000189394;             %87-86 - 16
Dist(84,2)=2;             %Configuração 2-6

Dist(115,1)=250*0.000189394;             %83-82 - 17
Dist(115,2)=2;             %Configuração 2-6

Dist(95,1)=175*0.000189394;             %87-88 - 18
Dist(95,2)=3;             %Configuração 3-9

Dist(83,1)=275*0.000189394;             %89-87 - 19
Dist(83,2)=2;             %Configuração 2-6

Dist(94,1)=225*0.000189394;             %89-90 - 20
Dist(94,2)=4;             %Configuração 4-10

Dist(82,1)=225*0.000189394;             %91-89 - 21
Dist(82,2)=2;             %Configuração 2-6

Dist(93,1)=300*0.000189394;             %91-92 - 22
Dist(93,2)=5;             %Configuração 5-11

Dist(81,1)=225*0.000189394;             %93-91 - 23
Dist(81,2)=2;             %Configuração 2-6

Dist(92,1)=275*0.000189394;             %93-94 - 24
Dist(92,2)=3;             %Configuração 3-9

Dist(80,1)=300*0.000189394;             %95-93 - 25
Dist(80,2)=2;             %Configuração 2-6

Dist(79,1)=200*0.000189394;             %96-95 - 26
Dist(79,2)=4;             %Configuração 4-10

%Potência nos nós em estrela e delta (TC = Tipo de carga: 1-S, 2-I ou 3-Z)
%PPA = Percentual de Potência Ativa
PPA = 0             %Nó 160 - 1
SN(1:3,78)=[0,0,0];
SN(4:6,78)=[0,0,0];

PPA = 0             %Nó 67 - 2
SN(1:3,88)=[0,0,0];                                                                                                         
SN(4:6,88)=[0,0,0];

PPA = 0             %Nó 72 - 3
SN(1:3,87)=[0,0,0];                                                                                            
SN(4:6,87)=[0,0,0];

PPA = 0             %Nó 73 - 4
SN(1:3,98)=[0,0,((40+j*20)*1e3)];                                                                                                         
TC_Y(98) = 1;
SN(4:6,98)=[0,0,0];

PPA = 0             %Nó 74 - 5  
SN(1:3,106)=[0,0,((40+1i*20)*1e3)];                                                                                         
TC_Y(106) = 3;
SN(4:6,106)=[0,0,0];

PPA = 0             %Nó 75 - 6
SN(1:3,109)=[0,0,((40+j*20)*1e3)];
TC_Y(109) = 1;
SN(4:6,109)=[0,0,0];

PPA = 0             %Nó 76 - 7
SN(1:3,86)=[0,0,0];                                                                                                       
SN(4:6,86)=[((105+1i*80)*1e3),((70+1i*50)*1e3),((70+1i*50)*1e3)];
TC_D(86) = 2;

PPA = 0             %Nó 77 - 8
SN(1:3,97)=[0,((40+1i*20)*1e3),0];                                                                                                                       
TC_Y(97) = 1;
SN(4:6,97)=[0,0,0];

PPA = 0             %Nó 78 - 9 
SN(1:3,105)=[0,0,0];                                                                                                                       
SN(4:6,105)=[0,0,0];

PPA = 0             %Nó 80 - 10 
SN(1:3,108)=[(40+j*20)*1e3,0,0];                                                                                       
TC_Y(108) = 1;
SN(4:6,108)=[0,0,0];

PPA = 0             %Nó 81 - 11
SN(1:3,116)=[0,0,0];
SN(4:6,116)=[0,0,0];

PPA = 0             %Nó 84 - 12
SN(1:3,120)=[0,0,((20+j*10)*1e3)];                                                                                           
TC_Y(120) = 1;
SN(4:6,120)=[0,0,0];

PPA = 0             %Nó 85 - 13
SN(1:3,123)=[0,0,((40+j*20)*1e3)];                                                                                               
TC_Y(123) = 1;
SN(4:6,123)=[0,0,0];

PPA = 0             %Nó 86 - 14 
SN(1:3,85)=[0,((20+1i*10)*1e3),0];                                                                                          
TC_Y(85) = 1;
SN(4:6,85)=[0,0,0];

PPA = 0             %Nó 79 - 15
SN(1:3,104)=[((40+1i*20)*1e3),0,0];                                                                                                     
TC_Y(104) = 3;
SN(4:6,104)=[0,0,0];

PPA = 0             %Nó 82 - 16 
SN(1:3,115)=[((40+j*20)*1e3),0,0];
TC_Y(115) = 1;
SN(4:6,115)=[0,0,0];

PPA = 0             %Nó 87 - 17
SN(1:3,84)=[0,((40+1i*20)*1e3),0];                                                                                             
TC_Y(84) = 1;
SN(4:6,84)=[0,0,0];

PPA = 0             %Nó 88 - 18
SN(1:3,96)=[((40+1i*20)*1e3)-1i*50*1e3,0,0];                                                                                                         
TC_Y(96) = 1;
SN(4:6,96)=[0,0,0];

PPA = 0             %Nó 83 - 19 
SN(1:3,114)=[-1i*200*1e3,-1i*200*1e3,((20+1i*10)*1e3)-1i*200*1e3]; 
TC_Y(114) = 1;
SN(4:6,114)=[0,0,0];

PPA = 0             %Nó 89 - 20
SN(1:3,83)=[0,0,0];                                                
SN(4:6,83)=[0,0,0];

PPA = 0             %Nó 90 - 21
SN(1:3,95)=[0,((40+1i*20)*1e3)-1i*50*1e3,0];                                                                                                         
TC_Y(95) = 2;
SN(4:6,95)=[0,0,0];

PPA = 0             %Nó 91 - 22 
SN(1:3,82)=[0,0,0];                                                                                                 
SN(4:6,82)=[0,0,0];

PPA = 0             %Nó 92 - 23
SN(1:3,94)=[0,0,((40+1i*20)*1e3)-j*50*1e3];    
TC_Y(94) = 1;
SN(4:6,94)=[0,0,0];

PPA = 0             %Nó 93 - 24
SN(1:3,81)=[0,0,0];                                                                     
SN(4:6,81)=[0,0,0];

PPA = 0             %Nó 94 - 25
SN(1:3,93)=[((40+1i*20)*1e3),0,0];
TC_Y(93) = 1;
SN(4:6,93)=[0,0,0];

PPA = 0             %Nó 95 - 26
SN(1:3,80)=[0,((20+1i*10)*1e3),0];
TC_Y(80) = 1;
SN(4:6,80)=[0,0,0];

PPA = 0             %Nó 96 - 27
SN(1:3,79)=[0,((20+1i*10)*1e3),0];
TC_Y(79) = 1;
SN(4:6,79)=[0,0,0];

%Tensão de referência
Vref = (4.16*10^3)/sqrt(3);

%Erro
Erro = 0.001;

