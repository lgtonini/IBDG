
clear all
close all
clc 

%Entrada de dos do IEEE - 13

%Configuração
[0,0,0,0,1,0,0,0,0;0,0,0,0,2,0,0,0,0;1,2,1,2,1,2,1,3,1;0,0,0,0,2,0,0,0,0;1,2,1,2,1,2,1,2,1;0,0,2,0,2,0,0,0,0;0,0,1,0,1,0,0,0,0]

%Quantidade de configurações de Linha
7

%Configurações Y e Z
MC_Y(1:3,1:3) = (10^-6)*[6.2998 -1.9958 -1.2595; -1.9958 5.9597 -0.7417; -1.2595 -0.7417 5.6386]; %601 - 1
MC_Z(1:3,1:3) = [0.3465+j*1.0179 0.1560+j*0.5017 0.1580+j*0.4236; 0.1560+j*0.5017 0.3375+j*1.0478 0.1535+j*0.3849; 0.1580+j*0.4236 0.1535+j*0.3849 0.3414+j*1.0348];

MC_Y(1:3,4:6) = (10^-6)*[5.6990 -1.0817 -1.6905; -1.0817 5.1795 -0.6588; -1.6905 -0.6588 5.4246]; %602 - 2
MC_Z(1:3,4:6) = [0.7526+j*1.1814 0.1580+j*0.4236 0.1560+j*0.5017; 0.1580+j*0.4236 0.7475+j*1.1983 0.1535+j*0.3849; 0.1560+j*0.5017 0.1535+j*0.3849 0.7436+j*1.2112]; 

MC_Y(1:3,7:9) = (10^-6)*[0.00000000001 0 0; 0 4.7097 -0.8999; 0 -0.8999 4.6658];                  %603 - 3
MC_Z(1:3,7:9) = [0.0000000001 0 0; 0 1.3294+j*1.3471 0.2066+j*0.4591; 0 0.2066+j*0.4591 1.3238+j*1.3569];

MC_Y(1:3,10:12) = (10^-6)*[4.6658 0 -0.8999; 0 0.00000000001 0; -0.8999 0 4.7097];                %604 - 4
MC_Z(1:3,10:12) = [1.3238+j*1.3569 0 0.2066+j*0.4591; 0 0.0000000001 0; 0.2066+j*0.4591 0 1.3294+j*1.3471];

MC_Y(1:3,13:15) = (10^-6)*[0.00000000001 0 0; 0 0.00000000001 0; 0 0 4.5193];                     %605 - 5
MC_Z(1:3,13:15) = [0.0000000001 0 0; 0 0.0000000001 0; 0 0 1.3292+j*1.3475];

MC_Y(1:3,16:18) = (10^-6)*[96.8897 0 0; 0 96.8897 0; 0 0 96.8897];                                %606 - 6
MC_Z(1:3,16:18) = [0.7982+j*0.4463 0.3192+j*0.0328 0.2849-j*0.0143; 0.3192+j*0.0328 0.7891+j*0.4041 0.3192+j*0.0328; 0.2849-j*0.0143 0.3192+j*0.0328 0.7982+j*0.4463];

MC_Y(1:3,19:21) = (10^-6)*[88.9912 0 0; 0 0.00000000001 0; 0 0 0.00000000001];                    %607 - 7
MC_Z(1:3,19:21) = [1.3425+j*0.5124 0 0; 0 0.0000000001 0; 0 0 0.0000000001];

%Distâncias e configuração entre os nós
Dist(1,1)=2000*0.000189394;             %650-632 - 1-2
Dist(1,2)=1;             %601 - 1-2

Dist(2,1)=300*0.000189394;              %645-646 - 5-6
Dist(2,2)=3;             %603 - 5-6

Dist(3,1)=500*0.000189394;              %632-645 - 2-5
Dist(3,2)=3;             %603 - 2-5

Dist(4,1)=500*0.000189394;              %632-633 - 2-3
Dist(4,2)=2;             %602 - 2-3

Dist(5,1)=0*0.000189394;             %633-634 - 3-4 - Transformador
Dist(5,2)=2;             %602* - 3-4

Dist(6,1)=2000*0.000189394;             %632-671 - 2-7
Dist(6,2)=1;             %601 - 2-7

Dist(7,1)=300*0.000189394;              %684-611 - 11-13
Dist(7,2)=5;             %605 - 11-13

Dist(8,1)=300*0.000189394;              %671-684 - 7-11
Dist(8,2)=4;             %604 - 7-11

Dist(9,1)=500*0.000189394;              %671-692 - 7-9
Dist(9,2)=6;             %606 - 7-9

Dist(10,1)=500*0.000189394;             %692-675 - 9-10
Dist(10,2)=6;            %606 - 9-10

Dist(11,1)=800*0.000189394;             %684-652 - 11-12
Dist(11,2)=7;            %607 - 11-12

Dist(12,1)=1000*0.000189394;            %671-680 - 7-8
Dist(12,2)=1;            %601 - 7-8

%Potência nos nós em estrela e delta
PPA = 0;
SN(1:3,1)=[0,0,0];                                                                                %650 - 1 
SN(4:6,1)=[0,0,0];

PPA = 0;
SN(1:3,2)=[0,0,0];                                                                                %646 - 2
SN(4:6,2)=2*[0,(230+132*1i)*10^3,0];
TC_D(2) = 3;

PPA = 0;
SN(1:3,3)=2*[0,(170+125*j)*10^3,0];                                                                 %645 - 3
TC_Y(3) = 1;
SN(4:6,3)=[0,0,0];

PPA = 0;
SN(1:3,4)=2*[(8.5+5*j)*10^3,(33+19*j)*10^3,(58.5+34*j)*10^3];                                       %632 - 4
TC_Y(4) = 1;
SN(4:6,4)=[0,0,0];

PPA = 0;
SN(1:3,5)=[0,0,0];                                                                                %633 - 5
SN(4:6,5)=[0,0,0];

PPA = 0;
SN(1:3,6)=2*[(160+110*1i)*10^3,(120+90*j)*10^3,(120+90*j)*10^3];                                    %634 - 6
TC_Y(6) = 1;
SN(4:6,6)=[0,0,0];

PPA = 0;
SN(1:3,7)=2*[0,0,(170+80*j)*10^3];                                                                  %611 - 7
TC_Y(7) = 2;
SN(4:6,7)=[0,0,0];

PPA = 0;
SN(1:3,8)=[0,0,0];                                                                                %684 - 8
SN(4:6,8)=[0,0,0];

PPA = 0;
SN(1:3,9)=2*[(8.5+5*j)*10^3,(33+19*j)*10^3,(58.5+34*j)*10^3];                                       %671 - 9
TC_Y(9) = 1;
SN(4:6,9)=2*[((385)+(220)*j)*10^3,((385)+(220)*j)*10^3,((385)+(220)*j)*10^3];
TC_D(9) = 1;

PPA = 0;
SN(1:3,10)=[0,0,0];                                                                               %692 - 10
SN(4:6,10)=2*[0,0,(170+151*j)*10^3];
TC_D(10) = 2;

PPA = 0;
SN(1:3,11)=2*[(485+190*j)*10^3,(68+60*j)*10^3,(290+212*j)*10^3];                                    %675 - 11
TC_Y(11) = 1;
SN(4:6,11)=[0,0,0];

PPA = 0;
SN(1:3,12)=2*[(128+86*j)*10^3,0,0];                                                                 %652 - 12
TC_Y(12) = 3;
SN(4:6,12)=[0,0,0];

PPA = 0;
SN(1:3,13)=[0,0,0];                                                                               %680 - 13
SN(4:6,13)=[0,0,0];

%Transformador:
    %Configurações 
1;
    %Tipo de transformador(1-DYg e 2-YgYg)
2;
    %Potência(VA)
500*10^3;
    %Tensão de entrada(V)
4.16*10^3;
    %Tensão de saída(V)
0.48*10^3;
    %Impedâcia
0.011+j*0.02;

%Regulador de tensão:
    %Relação de transformação
20;
    %Impedância
(3+9*j)/100;

%Tensão de referência
Vref = 4.16*10^3/sqrt(3);

%Erro do cálculo do FP
Erro = 0.001;

%Impedância de Falta
ZFalta = 0;
