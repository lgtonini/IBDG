
clear all
close all
clc 

%Entrada de dos do IEEE - 123 - Regulador 1

%Coordenadas/Configuração (1-Nó, 2-Linha, 3-Transformador, 4-Regulador e 9-Nó auxiliar)
M = [0,0,1,0,0,0,0,0,0;0,0,2,0,0,0,0,0,0;0,0,1,2,1,2,1,2,1;0,0,2,0,2,0,0,0,0;1,2,1,0,1,0,0,0,0;0,0,2,0,0,0,0,0,0;0,0,1,2,1,0,0,0,0;0,0,2,0,0,0,0,0,0;0,0,1,2,1,2,1,0,0;0,0,2,0,0,0,0,0,0;0,0,1,2,1,0,0,0,0;0,0,2,0,0,0,0,0,0;0,0,1,0,0,0,0,0,0;0,0,2,0,0,0,0,0,0;0,0,1,0,0,0,0,0,0;0,0,2,0,0,0,0,0,0;0,0,1,0,0,0,0,0,0;0,0,2,0,0,0,0,0,0;0,0,1,0,0,0,0,0,0];

%Quantidade de configurações
NC = 7; 

%Configurações Y e Z
MC_Y(1:3,1:3) = (10^-6)*[5.6765 -1.8319 -0.6982; 0 5.9809 -1.1645; 0 0 5.3971];   %Configuração 1 - 1
MC_Z(1:3,1:3) = [0.4576+j*1.0780 0.1560+j*0.5017 0.1535+j*0.3849; 0 0.4666+j*1.0482 0.1580+j*0.4236; 0 0 0.4615+j*1.0651];

MC_Y(1:3,4:6) = (10^-6)*[5.9809 -1.1645 -1.8319; 0 5.3971 -0.6982; 0 0 5.6765];   %Configuração 2 - 2
MC_Z(1:3,4:6) = [0.4666+j*1.0482 0.1580+j*0.4236 0.1560+j*0.5017; 0 0.4615+j*1.0651 0.1535+j*0.3849; 0 0 0.4576+j*1.0780];

MC_Y(1:3,10:12) = (10^-6)*[5.3971 -1.1645 -0.6982; 0 5.9809 -1.8319; 0 0 5.6765]; %Configuração 4 - 3
MC_Z(1:3,10:12) = [0.4615+j*1.0651 0.1580+j*0.4236 0.1535+j*0.3849; 0 0.4666+j*1.0482 0.1560+j*0.5017; 0 0 0.4576+j*1.0780];

MC_Y(1:3,22:24) = (10^-6)*[5.1154 -1.0549 0; 0 5.1704 0; 0 0 0];                  %Configuração 8 - 4
MC_Z(1:3,22:24) = [0.4676+j*1.0780 0.1535+j*0.3849 0; 0 0.4615+j*1.0651 0; 0 0 0];

MC_Y(1:3,25:27) = (10^-6)*[4.5193 0 0; 0 0 0; 0 0 0];                             %Configuração 9 - 5
MC_Z(1:3,25:27) = [1.3292+j*1.3475 0 0; 0 0 0; 0 0 0];

MC_Y(1:3,28:30) = (10^-6)*[0 0 0; 0 4.5193 0; 0 0 0];                             %Configuração 10 - 6
MC_Z(1:3,28:30) = [0 0 0; 0 1.3292+j*1.3475 0; 0 0 0];

MC_Y(1:3,31:33) = (10^-6)*[0 0 0; 0 0 0; 0 0 4.5193];                             %Configuração 11 - 7
MC_Z(1:3,31:33) = [0 0 0; 0 0 0; 0 0 1.3292+j*1.3475];

%Distâncias e configuração entre os nós
Dist(27,1)=375*0.000189394;             %35-135 - 1
Dist(27,2)=3;             %Configuração 3-4

Dist(16,1)=650*0.000189394;           %35-36 - 2
Dist(16,2)=4;             %Configuração 4-8

Dist(10,1)=250*0.000189394;             %38-36 - 3
Dist(10,2)=6;             %Configuração 6-10

Dist(7,1)=325*0.000189394;           %39-38 - 4
Dist(7,2)=6;            %Configuração 6-10

Dist(26,1)=250*0.000189394;            %40-35 - 5
Dist(26,2)=1;             %Configuração 1-1 

Dist(13,1)=300*0.000189394;           %36-37 - 6
Dist(13,2)=5;             %Configuração 5-9

Dist(37,1)=325*0.000189394;            %40-41 - 7
Dist(37,2)=7;             %Configuração 7-11 

Dist(25,1)=250*0.000189394;            %42-40 - 8
Dist(25,2)=1;             %Configuração 1-1 

Dist(36,1)=500*0.000189394;            %42-43 - 9
Dist(36,2)=4;             %Configuração 6-10 

Dist(24,1)=200*0.000189394;             %44-42 - 10
Dist(24,2)=1;            %Configuração 1-1

Dist(35,1)=200*0.000189394;             %44-45 - 11
Dist(35,2)=4;             %Configuração 6-10

Dist(42,1)=300*0.000189394;           %45-46 - 12
Dist(42,2)=3;            %Configuração 5-9

Dist(23,1)=250*0.000189394;            %47-44 - 13
Dist(23,2)=1;            %Configuração 1-1

Dist(34,1)=150*0.000189394;            %47-48 - 14
Dist(34,2)=3;             %Configuração 3-4 

Dist(22,1)=250*0.000189394;            %49-47 - 15
Dist(22,2)=3;             %Configuração 3-4

Dist(21,1)=250*0.000189394;           %50-49 - 16
Dist(21,2)=3;             %Configuração 3-4

Dist(20,1)=250*0.000189394;              %51-50 - 17
Dist(20,2)=3;             %Configuração 3-4

Dist(19,1)=0;           %151-51 - 18
Dist(19,2)=3;             %Configuração 3-4


%Potência nos nós em estrela e delta (TC = Tipo de carga: 1-S, 2-I ou 3-Z)
%PPA = Percentual de Potência Ativa
PPA = 0             %Nó 135 - 1
SN(1:3,28)=[0,0,0];                                                                                                                      
SN(4:6,28)=[0,0,0];

PPA = 0             %Nó 35 - 2
SN(1:3,27)=[0,0,0];                                                                                                   
SN(4:6,27)=[((40+1i*20)*1e3),0,0];
TC_D(27) = 1; 

PPA = 0             %Nó 36 - 3 
SN(1:3,13)=[0,0,0];                                                                                                                   
SN(4:6,13)=[0,0,0];

PPA = 0             %Nó 38 - 4 
SN(1:3,9)=[0,((20+1i*10)*1e3),0];   
TC_Y(9) = 2;
SN(4:6,9)=[0,0,0];  

PPA = 0             %Nó 39 - 5
SN(1:3,3)=[0,((20+1i*10)*1e3),0];                                                                                                                                                                                                 
TC_Y(3) = 1;
SN(4:6,3)=[0,0,0];

PPA = 0             %Nó 41 - 6
SN(1:3,38)=[0,0,((20+j*10)*1e3)];
TC_Y(38) = 1;
SN(4:6,38)=[0,0,0];

PPA = 0             %Nó 40 - 7 
SN(1:3,26)=[0,0,0];                                                                                                     
SN(4:6,26)=[0,0,0];

PPA = 0             %Nó 37 - 8
SN(1:3,14)=[((40+1i*20)*1e3),0,0]; 
TC_Y(14) = 3;
SN(4:6,14)=[0,0,0];

PPA = 0             %Nó 42 - 9
SN(1:3,25)=[((20+1i*10)*1e3),0,0];                                                                                  
TC_Y(25) = 1;
SN(4:6,25)=[0,0,0];

PPA = 0             %Nó 43 - 10 
SN(1:3,37)=[0,((40+j*20)*1e3),0];
TC_Y(37) = 3;
SN(4:6,37)=[0,0,0];

PPA = 0             %Nó 44 - 11  
SN(1:3,24)=[0,0,0];                                                                        
SN(4:6,24)=[0,0,0];

PPA = 0             %Nó 45 - 12 
SN(1:3,36)=[((20+j*10)*1e3),0,0];
TC_Y(36) = 2;
SN(4:6,36)=[0,0,0];

PPA = 0             %Nó 46 - 13
SN(1:3,43)=[((20+1i*10)*1e3),0,0];                                                                                          
TC_Y(43) = 1;
SN(4:6,43)=[0,0,0];

PPA = 0             %Nó 47 - 14
SN(1:3,23)=[(35+j*25)*1e3,(35+j*25)*1e3,(35+j*25)*1e3];                                                                     
TC_Y(23) = 2;
SN(4:6,23)=[0,0,0];

PPA = 0             %Nó 48 - 15
SN(1:3,35)=[((70+j*50)*1e3),((70+j*50)*1e3),((70+j*50)*1e3)];                                                                            
TC_Y(35) = 3;
SN(4:6,35)=[0,0,0];

PPA = 0             %Nó 49 - 16
SN(1:3,22)=[(35+j*25)*1e3,(70+j*50)*1e3,(35+j*20)*1e3];                                                                                                                      
TC_Y(22) = 1;
SN(4:6,22)=[0,0,0];

PPA = 0             %Nó 50 - 17
SN(1:3,21)=[0,0,((40+j*20)*1e3)];                                                                                                         
TC_Y(21) = 1;
SN(4:6,21)=[0,0,0];

PPA = 0             %Nó 51 - 18
SN(1:3,20)=[((20+j*10)*1e3),0,0];                                                                                                                       
TC_D(20) = 1;
SN(4:6,20)=[0,0,0];

PPA = 0             %Nó 151 - 19
SN(1:3,19)=[0,0,0];                                                                                                        
SN(4:6,19)=[0,0,0];

%Tensão de referência
Vref = (4.16*10^3)/sqrt(3);

%Erro
Erro = 0.001;

